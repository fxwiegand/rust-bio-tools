{
  "$schema":"https://vega.github.io/schema/vega-lite/v4.json",
  "datasets":{
    "main": {},
    "impact": {},
    "clin_sig": {}
  },
  "autosize":{
    "type":"fit",
    "contains":"padding"
  },
  "spacing": 30,
  "vconcat":[
    { "data":
      {
        "name": "main"
      },
      "mark":"bar",
      "height": 100,
      "encoding":{
        "x":{
          "field":"sample",
          "type":"ordinal",
          "scale":{

          },
          "axis":null,
          "sort":{
            "op":"valid",
            "field":"count_variants",
            "order":"descending"
          }
        },
        "y":{
          "field":"count_variants",
          "aggregate":"count",
          "type":"quantitative",
          "axis": {
            "title": "variant distribution per sample"
          }
        },
        "color":{
          "field":"count_variants",
          "type":"nominal",
          "title":"Variants",
          "legend": null,
          "scale":{
            "domain":[
              "SNV",
              "MNV",
              "DEL",
              "INS",
              "DUP",
              "INV",
              "BND",
              "Complex"
            ],
            "range":[
              "#a6cee3",
              "#1f78b4",
              "#b2df8a",
              "#33a02c",
              "#fb9a99",
              "#e31a1c",
              "#fdbf6f",
              "#ff7f00"
            ],
            "type":"ordinal"
          }
        }
      }
    },
    {
      "spacing":30,
      "bounds":"flush",
      "resolve": {"scale": {"color": "independent"}},
      "hconcat":[
        {
          "layer":[
            {
              "data":
              {
                "name": "main"
              },
              "mark":{
                "type":"square",
                "size":350,
                "opacity":1
              },
              "selection":{
                "highlight1":{
                  "type":"single",
                  "empty":"none",
                  "on":"mouseover",
                  "fields":[
                    "gene"
                  ]
                }
              },
              "encoding":{
                "x":{
                  "field":"sample",
                  "type":"ordinal",
                  "scale":{

                  },
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "y":{
                  "field":"gene",
                  "type":"ordinal",
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "fillOpacity":{
                  "condition":{
                    "selection":"highlight1",
                    "value":0.8
                  },
                  "value":1
                },
                "color":{
                  "field":"variants1",
                  "type":"nominal",
                  "title":"Variants",
                  "scale":{
                    "domain":[
                      "SNV",
                      "MNV",
                      "DEL",
                      "INS",
                      "DUP",
                      "INV",
                      "BND",
                      "Complex"
                    ],
                    "range":[
                      "#a6cee3",
                      "#1f78b4",
                      "#b2df8a",
                      "#33a02c",
                      "#fb9a99",
                      "#e31a1c",
                      "#fdbf6f",
                      "#ff7f00"
                    ],
                    "type":"ordinal"
                  }
                },
                "tooltip":[
                  {
                    "field":"gene",
                    "type":"nominal"
                  },
                  {
                    "field":"sample",
                    "type":"nominal"
                  },
                  {
                    "field":"dna_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"protein_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"variants",
                    "type":"ordinal"
                  }
                ]
              }
            },
            {
              "data":
              {
                "name": "main"
              },
              "mark":{
                "type":"square",
                "size":250,
                "opacity":1
              },
              "selection":{
                "highlight2":{
                  "type":"single",
                  "empty":"none",
                  "on":"mouseover",
                  "fields":[
                    "gene"
                  ]
                }
              },
              "encoding":{
                "x":{
                  "field":"sample",
                  "type":"ordinal",
                  "scale":{

                  },
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "y":{
                  "field":"gene",
                  "type":"ordinal",
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "fillOpacity":{
                  "condition":{
                    "selection":"highlight2",
                    "value":0.8
                  },
                  "value":1
                },
                "color":{
                  "field":"variants2",
                  "type":"nominal",
                  "title":"Variants",
                  "scale":{
                    "domain":[
                      "SNV",
                      "MNV",
                      "DEL",
                      "INS",
                      "DUP",
                      "INV",
                      "BND",
                      "Complex"
                    ],
                    "range":[
                      "#a6cee3",
                      "#1f78b4",
                      "#b2df8a",
                      "#33a02c",
                      "#fb9a99",
                      "#e31a1c",
                      "#fdbf6f",
                      "#ff7f00"
                    ],
                    "type":"ordinal"
                  }
                },
                "tooltip":[
                  {
                    "field":"gene",
                    "type":"nominal"
                  },
                  {
                    "field":"sample",
                    "type":"nominal"
                  },
                  {
                    "field":"dna_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"protein_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"variants",
                    "type":"ordinal"
                  }
                ]
              }
            },
            {
              "data":
              {
                "name": "main"
              },
              "mark":{
                "type":"square",
                "size":200,
                "opacity":1
              },
              "selection":{
                "highlight3":{
                  "type":"single",
                  "empty":"none",
                  "on":"mouseover",
                  "fields":[
                    "gene"
                  ]
                }
              },
              "encoding":{
                "x":{
                  "field":"sample",
                  "type":"ordinal",
                  "scale":{

                  },
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "y":{
                  "field":"gene",
                  "type":"ordinal",
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "fillOpacity":{
                  "condition":{
                    "selection":"highlight3",
                    "value":0.8
                  },
                  "value":1
                },
                "color":{
                  "field":"variants3",
                  "type":"nominal",
                  "title":"Variants",
                  "scale":{
                    "domain":[
                      "SNV",
                      "MNV",
                      "DEL",
                      "INS",
                      "DUP",
                      "INV",
                      "BND",
                      "Complex"
                    ],
                    "range":[
                      "#a6cee3",
                      "#1f78b4",
                      "#b2df8a",
                      "#33a02c",
                      "#fb9a99",
                      "#e31a1c",
                      "#fdbf6f",
                      "#ff7f00"
                    ],
                    "type":"ordinal"
                  }
                },
                "tooltip":[
                  {
                    "field":"gene",
                    "type":"nominal"
                  },
                  {
                    "field":"sample",
                    "type":"nominal"
                  },
                  {
                    "field":"dna_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"protein_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"variants",
                    "type":"ordinal"
                  }
                ]
              }
            },
            {
              "data":
              {
                "name": "main"
              },
              "mark":{
                "type":"square",
                "size":170,
                "opacity":1
              },
              "selection":{
                "highlight4":{
                  "type":"single",
                  "empty":"none",
                  "on":"mouseover",
                  "fields":[
                    "gene"
                  ]
                }
              },
              "encoding":{
                "x":{
                  "field":"sample",
                  "type":"ordinal",
                  "scale":{

                  },
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "y":{
                  "field":"gene",
                  "type":"ordinal",
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "fillOpacity":{
                  "condition":{
                    "selection":"highlight4",
                    "value":0.8
                  },
                  "value":1
                },
                "color":{
                  "field":"variants4",
                  "type":"nominal",
                  "title":"Variants",
                  "scale":{
                    "domain":[
                      "SNV",
                      "MNV",
                      "DEL",
                      "INS",
                      "DUP",
                      "INV",
                      "BND",
                      "Complex"
                    ],
                    "range":[
                      "#a6cee3",
                      "#1f78b4",
                      "#b2df8a",
                      "#33a02c",
                      "#fb9a99",
                      "#e31a1c",
                      "#fdbf6f",
                      "#ff7f00"
                    ],
                    "type":"ordinal"
                  }
                },
                "tooltip":[
                  {
                    "field":"gene",
                    "type":"nominal"
                  },
                  {
                    "field":"sample",
                    "type":"nominal"
                  },
                  {
                    "field":"dna_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"protein_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"variants",
                    "type":"ordinal"
                  }
                ]
              }
            },
            {
              "data":
              {
                "name": "main"
              },
              "mark":{
                "type":"square",
                "size":145,
                "opacity":1
              },
              "selection":{
                "highlight5":{
                  "type":"single",
                  "empty":"none",
                  "on":"mouseover",
                  "fields":[
                    "gene"
                  ]
                }
              },
              "encoding":{
                "x":{
                  "field":"sample",
                  "type":"ordinal",
                  "scale":{

                  },
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "y":{
                  "field":"gene",
                  "type":"ordinal",
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "fillOpacity":{
                  "condition":{
                    "selection":"highlight5",
                    "value":0.8
                  },
                  "value":1
                },
                "color":{
                  "field":"variants5",
                  "type":"nominal",
                  "title":"Variants",
                  "scale":{
                    "domain":[
                      "SNV",
                      "MNV",
                      "DEL",
                      "INS",
                      "DUP",
                      "INV",
                      "BND",
                      "Complex"
                    ],
                    "range":[
                      "#a6cee3",
                      "#1f78b4",
                      "#b2df8a",
                      "#33a02c",
                      "#fb9a99",
                      "#e31a1c",
                      "#fdbf6f",
                      "#ff7f00"
                    ],
                    "type":"ordinal"
                  }
                },
                "tooltip":[
                  {
                    "field":"gene",
                    "type":"nominal"
                  },
                  {
                    "field":"sample",
                    "type":"nominal"
                  },
                  {
                    "field":"dna_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"protein_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"variants",
                    "type":"ordinal"
                  }
                ]
              }
            },
            {
              "data":
              {
                "name": "main"
              },
              "mark":{
                "type":"square",
                "size":120,
                "opacity":1
              },
              "selection":{
                "highlight6":{
                  "type":"single",
                  "empty":"none",
                  "on":"mouseover",
                  "fields":[
                    "gene"
                  ]
                }
              },
              "encoding":{
                "x":{
                  "field":"sample",
                  "type":"ordinal",
                  "scale":{

                  },
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "y":{
                  "field":"gene",
                  "type":"ordinal",
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "fillOpacity":{
                  "condition":{
                    "selection":"highlight6",
                    "value":0.8
                  },
                  "value":1
                },
                "color":{
                  "field":"variants6",
                  "type":"nominal",
                  "title":"Variants",
                  "scale":{
                    "domain":[
                      "SNV",
                      "MNV",
                      "DEL",
                      "INS",
                      "DUP",
                      "INV",
                      "BND",
                      "Complex"
                    ],
                    "range":[
                      "#a6cee3",
                      "#1f78b4",
                      "#b2df8a",
                      "#33a02c",
                      "#fb9a99",
                      "#e31a1c",
                      "#fdbf6f",
                      "#ff7f00"
                    ],
                    "type":"ordinal"
                  }
                },
                "tooltip":[
                  {
                    "field":"gene",
                    "type":"nominal"
                  },
                  {
                    "field":"sample",
                    "type":"nominal"
                  },
                  {
                    "field":"dna_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"protein_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"variants",
                    "type":"ordinal"
                  }
                ]
              }
            },
            {
              "data":
              {
                "name": "main"
              },
              "mark":{
                "type":"square",
                "size":95,
                "opacity":1
              },
              "selection":{
                "highlight7":{
                  "type":"single",
                  "empty":"none",
                  "on":"mouseover",
                  "fields":[
                    "gene"
                  ]
                }
              },
              "encoding":{
                "x":{
                  "field":"sample",
                  "type":"ordinal",
                  "scale":{

                  },
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "y":{
                  "field":"gene",
                  "type":"ordinal",
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "fillOpacity":{
                  "condition":{
                    "selection":"highlight7",
                    "value":0.8
                  },
                  "value":1
                },
                "color":{
                  "field":"variants7",
                  "type":"nominal",
                  "title":"Variants",
                  "scale":{
                    "domain":[
                      "SNV",
                      "MNV",
                      "DEL",
                      "INS",
                      "DUP",
                      "INV",
                      "BND",
                      "Complex"
                    ],
                    "range":[
                      "#a6cee3",
                      "#1f78b4",
                      "#b2df8a",
                      "#33a02c",
                      "#fb9a99",
                      "#e31a1c",
                      "#fdbf6f",
                      "#ff7f00"
                    ],
                    "type":"ordinal"
                  }
                },
                "tooltip":[
                  {
                    "field":"gene",
                    "type":"nominal"
                  },
                  {
                    "field":"sample",
                    "type":"nominal"
                  },
                  {
                    "field":"dna_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"protein_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"variants",
                    "type":"ordinal"
                  }
                ]
              }
            },
            {
              "data":
              {
                "name": "main"
              },
              "mark":{
                "type":"square",
                "size":70,
                "opacity":1
              },
              "selection":{
                "highlight8":{
                  "type":"single",
                  "empty":"none",
                  "on":"mouseover",
                  "fields":[
                    "gene"
                  ]
                }
              },
              "encoding":{
                "x":{
                  "field":"sample",
                  "type":"ordinal",
                  "scale":{

                  },
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "y":{
                  "field":"gene",
                  "type":"ordinal",
                  "sort":{
                    "op":"valid",
                    "field":"count_variants",
                    "order":"descending"
                  }
                },
                "fillOpacity":{
                  "condition":{
                    "selection":"highlight8",
                    "value":0.8
                  },
                  "value":1
                },
                "color":{
                  "field":"variants8",
                  "type":"nominal",
                  "title":"Variants",
                  "scale":{
                    "domain":[
                      "SNV",
                      "MNV",
                      "DEL",
                      "INS",
                      "DUP",
                      "INV",
                      "BND",
                      "Complex"
                    ],
                    "range":[
                      "#a6cee3",
                      "#1f78b4",
                      "#b2df8a",
                      "#33a02c",
                      "#fb9a99",
                      "#e31a1c",
                      "#fdbf6f",
                      "#ff7f00"
                    ],
                    "type":"ordinal"
                  }
                },
                "tooltip":[
                  {
                    "field":"gene",
                    "type":"nominal"
                  },
                  {
                    "field":"sample",
                    "type":"nominal"
                  },
                  {
                    "field":"dna_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"protein_alterations",
                    "type":"nominal"
                  },
                  {
                    "field":"variants",
                    "type":"ordinal"
                  }
                ]
              }
            }
          ]
        },
        {
          "data":
          {
            "name": "main"
          },
          "mark":"bar",
          "width":100,
          "encoding":{
            "y":{
              "field":"gene",
              "type":"ordinal",
              "sort":{
                "op":"valid",
                "field":"count_variants",
                "order":"descending"
              },
              "axis":null
            },
            "x":{
              "field":"count_variants",
              "aggregate":"count",
              "type":"quantitative",
              "axis": {
                "title": "variant distribution per gene"
              }
            },
            "color":{
              "field":"count_variants",
              "type":"nominal",
              "title":"Variants",
              "legend": null,
              "scale":{
                "domain":[
                  "SNV",
                  "MNV",
                  "DEL",
                  "INS",
                  "DUP",
                  "INV",
                  "BND",
                  "Complex"
                ],
                "range":[
                  "#a6cee3",
                  "#1f78b4",
                  "#b2df8a",
                  "#33a02c",
                  "#fb9a99",
                  "#e31a1c",
                  "#fdbf6f",
                  "#ff7f00"
                ],
                "type":"ordinal"
              }
            }
          }
        },
        {
          "data":{
            "name":"impact"
          },
          "mark":"bar",
          "width":100,
          "encoding":{
            "y":{
              "field":"gene",
              "type":"ordinal",
              "sort": {
                "field": "sort",
                "order": "descending"
              },
              "axis":null
            },
            "x":{
              "field":"count",
              "aggregate":"sum",
              "type":"quantitative",
              "axis":{
                "title":"impact"
              }
            },
            "color":{
              "field":"impact",
              "type":"nominal",
              "title":"Impact",
              "scale":{
                "domain":[
                  "HIGH",
                  "LOW",
                  "MODERATE",
                  "MODIFIER"
                ],
                "range": [
                  "31a354",
                  "756bb1",
                  "7f7f7f",
                  "bcbd22"
                ],
                "type":"ordinal"
              }
            }
          }
        },
        {
          "data":{
            "name":"clin_sig"
          },
          "mark":"bar",
          "width":100,
          "encoding":{
            "y":{
              "field":"gene",
              "type":"ordinal",
              "sort": {
                "field": "sort",
                "order": "descending"
              },
              "axis": null
            },
            "x":{
              "field":"count",
              "aggregate":"sum",
              "type":"quantitative",
              "axis":{
                "title":"clin_sig"
              }
            },
            "color":{
              "field":"clin_sig",
              "type":"nominal",
              "title":"Clin Sig",
              "scale":{
                "domain":[
                  "association",
                  "benign",
                  "drug_response",
                  "likely_benign",
                  "likely_pathogenic",
                  "not_provided",
                  "other",
                  "pathogenic",
                  "protective",
                  "risk_factor",
                  "uncertain_significance"
                ],
                "range": [
                  "17becf",
                  "e377c2",
                  "ad494a",
                  "e7ba52",
                  "b3de69",
                  "83bcb6",
                  "e45756",
                  "9e765f",
                  "ce6dbd",
                  "9edae5",
                  "fdae6b"
                ],
                "type":"ordinal"
              }
            }
          }
        }
      ]
    }
  ],
  "config": {
    "legend":{
      "orient": "bottom",
      "direction": "vertical"
    }
  }
}